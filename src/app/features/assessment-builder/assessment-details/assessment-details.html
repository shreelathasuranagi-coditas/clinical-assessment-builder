<div class="details-container">
  <div class="header">
    <h1>Assessment Details</h1>
    <button mat-icon-button (click)="goBack()">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  @if (assessment()) {
    <mat-card class="details-card">

      <!-- CONTENT (SCROLLABLE) -->
      <mat-card-content class="details-content">
        <form [formGroup]="form" class="form-container">

          <app-custom-input
            placeholder="Assessment Name"
            formControlName="name">
          </app-custom-input>

          <mat-error *ngIf="form.get('name')?.hasError('required')">
            Name is required
          </mat-error>
          <mat-error *ngIf="form.get('name')?.hasError('minlength')">
            Minimum 3 characters
          </mat-error>

          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Category</mat-label>
            <mat-select formControlName="category_id">
              @for (cat of categories; track cat.id) {
                <mat-option [value]="cat.id">{{ cat.label }}</mat-option>
              }
            </mat-select>
            <mat-error *ngIf="form.get('category_id')?.hasError('required')">
              Category is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Description (Optional)</mat-label>
            <textarea matInput rows="4" formControlName="description"></textarea>
          </mat-form-field>

        </form>
      </mat-card-content>

      <!-- ACTIONS (STICKY) -->
      <mat-card-actions class="details-actions">
        <app-button (clicked)="goBack()">Cancel</app-button>

        <app-button
          [disabled]="form.invalid"
          (clicked)="save()"
          [primary]="true">
          Save & Continue
        </app-button>

        <app-button
          [disabled]="form.invalid"
          (clicked)="goToQuestionBuilder()">
          Go to Question Builder
        </app-button>
      </mat-card-actions>

    </mat-card>
  }
</div>
