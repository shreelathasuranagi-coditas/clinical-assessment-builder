<div class="details-container">
  <div class="header">
    <h1>Assessment Details</h1>
    <button mat-icon-button (click)="goBack()">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  @if (assessment()) {
    <mat-card class="details-card">
      <mat-card-content>
        <form [formGroup]="form" class="form-container">

          <app-custom-input
            [placeholder]="'Assessment Name'"
            formControlName="name">
          </app-custom-input>
          @if (form.get('name')?.hasError('required')) {
            <mat-error>Name is required</mat-error>
          }
          @if (form.get('name')?.hasError('minlength')) {
            <mat-error>Minimum 3 characters</mat-error>
          }

          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Category</mat-label>
            <mat-select formControlName="category_id">
              @for (cat of categories; track cat.id) {
                <mat-option [value]="cat.id">{{ cat.label }}</mat-option>
              }
            </mat-select>
            @if (form.get('category_id')?.hasError('required')) {
              <mat-error>Category is required</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Description (Optional)</mat-label>
            <textarea matInput rows="4" formControlName="description"></textarea>
          </mat-form-field>

        </form>
      </mat-card-content>

      <mat-card-actions>
        <app-button (clicked)="goBack()">Cancel</app-button>
        <app-button
          [disabled]="form.invalid"
          (clicked)="save()"
          [primary]="true">
          Save & Continue
        </app-button>
        <app-button
          (clicked)="goToQuestionBuilder()"
          [disabled]="form.invalid">
          Go to Question Builder
        </app-button>
      </mat-card-actions>
    </mat-card>
  }
</div>
